<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Autonomous-Navigation/visual-slam-systems" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Lesson 2: Visual SLAM Systems | AI-Native Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/Autonomous-Navigation/visual-slam-systems"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lesson 2: Visual SLAM Systems | AI-Native Book"><meta data-rh="true" name="description" content="Duration CEFR B1-C2 | Priority Lesson 1"><meta data-rh="true" property="og:description" content="Duration CEFR B1-C2 | Priority Lesson 1"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/Autonomous-Navigation/visual-slam-systems"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Autonomous-Navigation/visual-slam-systems" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Autonomous-Navigation/visual-slam-systems" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Lesson 2: Visual SLAM Systems","item":"https://your-docusaurus-site.example.com/docs/Autonomous-Navigation/visual-slam-systems"}]}</script><link rel="stylesheet" href="/assets/css/styles.e8e42a22.css">
<script src="/assets/js/runtime~main.2a2f2056.js" defer="defer"></script>
<script src="/assets/js/main.903acabd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="AI Book Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="AI Book Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AI-Native Book</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Book</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/your-org/ai-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Welcome to the Physical AI Robotics Book" class="linkLabel_WmDU">Welcome to the Physical AI Robotics Book</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/-getting-started"><span title="ðŸš€ Getting Started" class="categoryLinkLabel_W154">ðŸš€ Getting Started</span></a><button aria-label="Expand sidebar category &#x27;ðŸš€ Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/-chapter-1-ros-2-basics"><span title="ðŸ“– Chapter 1: ROS 2 Basics" class="categoryLinkLabel_W154">ðŸ“– Chapter 1: ROS 2 Basics</span></a><button aria-label="Expand sidebar category &#x27;ðŸ“– Chapter 1: ROS 2 Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Gazebo-Simulation/intro"><span title="Gazebo-Simulation" class="categoryLinkLabel_W154">Gazebo-Simulation</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Autonomous-Navigation/intro"><span title="Autonomous-Navigation" class="categoryLinkLabel_W154">Autonomous-Navigation</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/intro"><span title="Chapter 3: Autonomous Navigation" class="linkLabel_WmDU">Chapter 3: Autonomous Navigation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/navigation-and-localization-overview"><span title="Lesson 1: Navigation and Localization Overview" class="linkLabel_WmDU">Lesson 1: Navigation and Localization Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Autonomous-Navigation/visual-slam-systems"><span title="Lesson 2: Visual SLAM Systems" class="linkLabel_WmDU">Lesson 2: Visual SLAM Systems</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/introduction-to-isaac-sim"><span title="Lesson 3: Introduction to Isaac Sim" class="linkLabel_WmDU">Lesson 3: Introduction to Isaac Sim</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/nav2-path-planning-stack"><span title="Lesson 4: Nav2 Path Planning Stack" class="linkLabel_WmDU">Lesson 4: Nav2 Path Planning Stack</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/obstacle-avoidance-and-dynamic-environments"><span title="Lesson 5: Obstacle Avoidance and Dynamic Environments" class="linkLabel_WmDU">Lesson 5: Obstacle Avoidance and Dynamic Environments</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/autonomous-humanoid-navigation"><span title="Lesson 6: Autonomous Humanoid Navigation" class="linkLabel_WmDU">Lesson 6: Autonomous Humanoid Navigation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/multi-sensor-perception-and-fusion"><span title="Lesson 7: Multi-Sensor Perception and Fusion" class="linkLabel_WmDU">Lesson 7: Multi-Sensor Perception and Fusion</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Autonomous-Navigation/capstone-mission"><span title="Lesson 8: Capstone - Autonomous Navigation End-to-End" class="linkLabel_WmDU">Lesson 8: Capstone - Autonomous Navigation End-to-End</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Autonomous-Navigation</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Lesson 2: Visual SLAM Systems</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div style="display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px;align-items:center"><div class="notAuthMessage_gyQm"><p>ðŸ”’ Please <a href="/signin">sign in</a> to access Urdu translation</p></div></div><div class="theme-doc-markdown markdown"><header><h1>Lesson 2: Visual SLAM Systems</h1></header>
<p><strong>Duration</strong>: 3 hours | <strong>Level</strong>: CEFR B1-C2 | <strong>Priority</strong>: P1 | <strong>Prerequisite</strong>: Lesson 1</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-outcomes">Learning Outcomes<a href="#learning-outcomes" class="hash-link" aria-label="Direct link to Learning Outcomes" title="Direct link to Learning Outcomes" translate="no">â€‹</a></h2>
<p>By the end of this lesson, you will be able to:</p>
<ol>
<li class=""><strong>Understand</strong> ORB-SLAM3 architecture and feature-based visual SLAM</li>
<li class=""><strong>Explain</strong> feature detection, matching, and pose estimation</li>
<li class=""><strong>Configure</strong> ORB-SLAM3 for monocular and stereo camera setups</li>
<li class=""><strong>Run</strong> VSLAM on simulated Gazebo data</li>
<li class=""><strong>Measure</strong> and optimize odometry accuracy</li>
<li class=""><strong>Debug</strong> SLAM failures (insufficient features, lighting issues)</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="layer-1-foundation">Layer 1: Foundation<a href="#layer-1-foundation" class="hash-link" aria-label="Direct link to Layer 1: Foundation" title="Direct link to Layer 1: Foundation" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-orb-slam3-architecture">2.1 ORB-SLAM3 Architecture<a href="#21-orb-slam3-architecture" class="hash-link" aria-label="Direct link to 2.1 ORB-SLAM3 Architecture" title="Direct link to 2.1 ORB-SLAM3 Architecture" translate="no">â€‹</a></h3>
<p><strong>ORB</strong> = <strong>O</strong>riented <strong>R</strong>FAST and <strong>B</strong>RIEF</p>
<p>ORB-SLAM3 is a complete visual SLAM system using ORB features. Why ORB?</p>
<ul>
<li class=""><strong>Fast Detection</strong>: FAST corner detection (~1000 features/frame)</li>
<li class=""><strong>Rotation-Invariant</strong>: BRIEF descriptors handle camera rotation</li>
<li class=""><strong>Efficient</strong>: Low computational cost, real-time performance</li>
</ul>
<p><strong>Complete system</strong> includes:</p>
<ol>
<li class=""><strong>Tracking</strong>: Feature detection and matching frame-to-frame</li>
<li class=""><strong>Mapping</strong>: Accumulating features into global structure</li>
<li class=""><strong>Loop Closing</strong>: Detecting and correcting revisited locations</li>
<li class=""><strong>Bundle Adjustment</strong>: Global optimization to minimize error</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-feature-detection-pipeline">2.2 Feature Detection Pipeline<a href="#22-feature-detection-pipeline" class="hash-link" aria-label="Direct link to 2.2 Feature Detection Pipeline" title="Direct link to 2.2 Feature Detection Pipeline" translate="no">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Raw image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”œâ”€â†’ FAST Corner Detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”‚       (identify key points)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”œâ”€â†’ BRIEF Descriptor Computation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”‚       (binary feature description)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    â””â”€â†’ Feature List</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [pt1, pt2, ..., ptN]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            (locations + descriptors)</span><br></span></code></pre></div></div>
<p><strong>FAST (Features from Accelerated Segment Test)</strong>:</p>
<ul>
<li class="">Detect corners by comparing pixel intensities around candidate point</li>
<li class="">Fast because it uses simple intensity comparisons</li>
<li class="">~1000-2000 features per frame in textured scenes</li>
</ul>
<p><strong>BRIEF (Binary Robust Independent Elementary Features)</strong>:</p>
<ul>
<li class="">Create binary descriptor (256 bits) for each feature</li>
<li class="">Fast to compute and match</li>
<li class="">Rotation variant (ORB variants fix this)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="23-feature-matching">2.3 Feature Matching<a href="#23-feature-matching" class="hash-link" aria-label="Direct link to 2.3 Feature Matching" title="Direct link to 2.3 Feature Matching" translate="no">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Frame t:  features [f1, f2, f3, ..., fn]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               â”œâ”€â†’ Descriptor matching with Frame t+1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Frame t+1: features [f&#x27;1, f&#x27;2, f&#x27;3, ..., f&#x27;m]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Result: Matched pairs = [(f1, f&#x27;3), (f2, f&#x27;1), ...]</span><br></span></code></pre></div></div>
<p><strong>Matching strategy</strong>:</p>
<ul>
<li class="">Compare BRIEF descriptors using Hamming distance</li>
<li class="">For each feature in frame t, find closest match in frame t+1</li>
<li class="">Use bidirectional matching (must match both directions)</li>
<li class="">Use outlier rejection (RANSAC) to remove false matches</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="24-pose-estimation-from-feature-matches">2.4 Pose Estimation from Feature Matches<a href="#24-pose-estimation-from-feature-matches" class="hash-link" aria-label="Direct link to 2.4 Pose Estimation from Feature Matches" title="Direct link to 2.4 Pose Estimation from Feature Matches" translate="no">â€‹</a></h3>
<p>Given matched features between consecutive frames, estimate camera motion:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3D point P(world) â”€â”€projectionâ”€â”€â†’ p1 (in frame t)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  p2 (in frame t+1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From p1 â†” p2 correspondence, recover:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Rotation: R (3Ã—3 matrix)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Translation: t (3D vector)</span><br></span></code></pre></div></div>
<p><strong>Method</strong>: Essential matrix decomposition</p>
<ul>
<li class="">Essential matrix E encodes both R and t</li>
<li class="">Computed from matched feature correspondences</li>
<li class="">Decompose E to recover R and t</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="25-local-mapping">2.5 Local Mapping<a href="#25-local-mapping" class="hash-link" aria-label="Direct link to 2.5 Local Mapping" title="Direct link to 2.5 Local Mapping" translate="no">â€‹</a></h3>
<p><strong>Keyframes</strong>: Not every frame is stored; only &quot;keyframes&quot; with sufficient motion/features</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Frame sequence:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Keyframe1] [frame2] [frame3] [Keyframe4] [frame5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (stored)  (used)   (used)    (stored)   (used)</span><br></span></code></pre></div></div>
<p><strong>Why keyframes?</strong></p>
<ul>
<li class="">Reduces memory usage</li>
<li class="">Speeds up processing</li>
<li class="">Filters out static frames</li>
</ul>
<p><strong>Local mapping process</strong>:</p>
<ol>
<li class="">New keyframe arrives</li>
<li class="">Add new 3D points from features without depth</li>
<li class="">Perform local bundle adjustment (optimize pose + structure)</li>
<li class="">Culling: Remove redundant points/keyframes</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="layer-2-collaboration-ros-2-integration">Layer 2: Collaboration (ROS 2 Integration)<a href="#layer-2-collaboration-ros-2-integration" class="hash-link" aria-label="Direct link to Layer 2: Collaboration (ROS 2 Integration)" title="Direct link to Layer 2: Collaboration (ROS 2 Integration)" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="21-orb-slam3-ros-2-wrapper">2.1 ORB-SLAM3 ROS 2 Wrapper<a href="#21-orb-slam3-ros-2-wrapper" class="hash-link" aria-label="Direct link to 2.1 ORB-SLAM3 ROS 2 Wrapper" title="Direct link to 2.1 ORB-SLAM3 ROS 2 Wrapper" translate="no">â€‹</a></h3>
<p><strong>Input</strong>: Camera calibration parameters</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># camera_calibration.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># focal length x (pixels)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># focal length y (pixels)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">320.0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># principal point x (pixels)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240.0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># principal point y (pixels)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.k1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># distortion coefficient</span><br></span></code></pre></div></div>
<p><strong>Camera topic interface</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ROS 2 Topic: /camera/image_raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ Type: sensor_msgs/msg/Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ Encoding: rgb8 or mono8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€ Frequency: 15-30 Hz (typical)</span><br></span></code></pre></div></div>
<p><strong>ORB-SLAM3 output topics</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/orb_slam3/pose           (nav_msgs/Odometry)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ pose.pose (position + orientation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ twist.twist (velocity estimate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€ header.frame_id = &quot;map&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/orb_slam3/trajectory     (geometry_msgs/PoseStamped array)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ All poses in trajectory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€ For visualization/analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/orb_slam3/tracked_points (sensor_msgs/PointCloud2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ 3D positions of tracked features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€ Used in RViz visualization</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="22-rviz-visualization">2.2 RViz Visualization<a href="#22-rviz-visualization" class="hash-link" aria-label="Direct link to 2.2 RViz Visualization" title="Direct link to 2.2 RViz Visualization" translate="no">â€‹</a></h3>
<p>Monitor SLAM progress in real-time:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RViz GUI:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ Map frame (map)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â”œâ”€ Tracked feature points (colored by depth)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â”œâ”€ Estimated trajectory (green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â””â”€ Ground truth trajectory (red, if available)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ Robot frame (base_link)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â”œâ”€ Current pose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â””â”€ Odometry frame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€ Camera view</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”œâ”€ Detected features (circles)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â””â”€ Tracked features (blue)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="layer-3-intelligence-configuration--tuning">Layer 3: Intelligence (Configuration &amp; Tuning)<a href="#layer-3-intelligence-configuration--tuning" class="hash-link" aria-label="Direct link to Layer 3: Intelligence (Configuration &amp; Tuning)" title="Direct link to Layer 3: Intelligence (Configuration &amp; Tuning)" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="31-camera-calibration">3.1 Camera Calibration<a href="#31-camera-calibration" class="hash-link" aria-label="Direct link to 3.1 Camera Calibration" title="Direct link to 3.1 Camera Calibration" translate="no">â€‹</a></h3>
<p><strong>Critical</strong>: ORB-SLAM3 requires accurate camera calibration</p>
<p><strong>Calibration parameters</strong> (from camera matrix K):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">K = [fx  0  cx]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [0  fy  cy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [0   0   1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Where:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- fx, fy = focal length (pixels)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- cx, cy = principal point (pixels)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Distortion coefficients: k1, k2, p1, p2, k3</span><br></span></code></pre></div></div>
<p><strong>For Gazebo simulated cameras</strong>:</p>
<ul>
<li class="">Use ideal parameters (no distortion)</li>
<li class="">fx = fy = focal_length (from camera plugin)</li>
<li class="">cx = image_width / 2</li>
<li class="">cy = image_height / 2</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="32-monocular-vslam-configuration">3.2 Monocular VSLAM Configuration<a href="#32-monocular-vslam-configuration" class="hash-link" aria-label="Direct link to 3.2 Monocular VSLAM Configuration" title="Direct link to 3.2 Monocular VSLAM Configuration" translate="no">â€‹</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># mono_settings.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PinHole&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.width</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">640</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.height</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">480</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">320.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Feature detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ORBextractor.nFeatures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># features per frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ORBextractor.scaleFactor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.2</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># image pyramid scale</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ORBextractor.nLevels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># pyramid levels</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Thresholds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ThFAST</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># FAST corner threshold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ThFASTinit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># initial frame threshold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ORB-SLAM3 specific</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">System.useStereo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">System.useRGBD</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">System.useIMU</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># use IMU if available</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="33-stereo-vslam-configuration">3.3 Stereo VSLAM Configuration<a href="#33-stereo-vslam-configuration" class="hash-link" aria-label="Direct link to 3.3 Stereo VSLAM Configuration" title="Direct link to 3.3 Stereo VSLAM Configuration" translate="no">â€‹</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># stereo_settings.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PinHole&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.width</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">640</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.height</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">480</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Left camera (reference)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.fy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">320.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Camera.cy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stereo baseline and other parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Stereo.baseline</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># baseline between cameras (meters)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">Stereo.ThDepth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># close/far threshold (pixels)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Feature detection (same as mono)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ORBextractor.nFeatures</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">ORBextractor.scaleFactor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">System.useStereo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="34-performance-optimization">3.4 Performance Optimization<a href="#34-performance-optimization" class="hash-link" aria-label="Direct link to 3.4 Performance Optimization" title="Direct link to 3.4 Performance Optimization" translate="no">â€‹</a></h3>
<p><strong>Parameter tuning for different scenarios</strong>:</p>
<table><thead><tr><th>Scenario</th><th>nFeatures</th><th>scaleFactor</th><th>ThFAST</th><th>Goal</th></tr></thead><tbody><tr><td>Textured indoors</td><td>2000</td><td>1.2</td><td>20</td><td>Balance accuracy and speed</td></tr><tr><td>Low texture</td><td>4000</td><td>1.2</td><td>10</td><td>More features, lenient detection</td></tr><tr><td>High speed</td><td>1000</td><td>1.3</td><td>30</td><td>Fast computation, sparse features</td></tr><tr><td>High accuracy</td><td>3000</td><td>1.2</td><td>15</td><td>More features, careful detection</td></tr></tbody></table>
<p><strong>Computational cost</strong>:</p>
<ul>
<li class="">Feature detection: ~30-50ms</li>
<li class="">Feature matching: ~20-40ms</li>
<li class="">Pose estimation: ~10-20ms</li>
<li class=""><strong>Total per frame</strong>: 60-110ms @ 15Hz = reasonable</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="layer-4-advanced">Layer 4: Advanced<a href="#layer-4-advanced" class="hash-link" aria-label="Direct link to Layer 4: Advanced" title="Direct link to Layer 4: Advanced" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="41-loop-closure-detection">4.1 Loop Closure Detection<a href="#41-loop-closure-detection" class="hash-link" aria-label="Direct link to 4.1 Loop Closure Detection" title="Direct link to 4.1 Loop Closure Detection" translate="no">â€‹</a></h3>
<p><strong>Problem</strong>: After 10 minutes of navigation, how does SLAM know if it has returned to a known location?</p>
<p><strong>Solution</strong>: Place recognition using visual similarity</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Loop closure pipeline:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ Current image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â”œâ”€ Extract features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â””â”€ Compute feature vector (&quot;bag of words&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ Query database of past keyframe bags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â””â”€ Find keyframes with similar bags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€ Candidate matches found?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚  â””â”€ YES â†’ Perform geometric verification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚       â”œâ”€ Match features between current and candidate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚       â”œâ”€ Compute similarity transform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚       â””â”€ If match strong â†’ declare loop closure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€ Loop closure correction:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”œâ”€ Optimize pose graph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”œâ”€ Correct all accumulated drift</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â””â”€ Fuse with previous estimate</span><br></span></code></pre></div></div>
<p><strong>Why geometric verification is crucial</strong>:</p>
<ul>
<li class="">Perceptual aliasing: Different places look similar</li>
<li class="">Need to verify with feature matches, not just appearance</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="42-inertial-measurement-unit-imu-integration">4.2 Inertial Measurement Unit (IMU) Integration<a href="#42-inertial-measurement-unit-imu-integration" class="hash-link" aria-label="Direct link to 4.2 Inertial Measurement Unit (IMU) Integration" title="Direct link to 4.2 Inertial Measurement Unit (IMU) Integration" translate="no">â€‹</a></h3>
<p>ORB-SLAM3 can fuse camera + IMU:</p>
<p><strong>Benefits</strong>:</p>
<ul>
<li class="">IMU provides immediate angular velocity information</li>
<li class="">Helps when visual features insufficient (motion blur, low light)</li>
<li class="">Enables scale recovery in monocular mode</li>
</ul>
<p><strong>Challenge</strong>: Temporal synchronization</p>
<ul>
<li class="">Camera and IMU have different timestamp frequencies</li>
<li class="">Must align on common time reference</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary" translate="no">â€‹</a></h2>
<table><thead><tr><th>Concept</th><th>Key Insight</th></tr></thead><tbody><tr><td><strong>ORB features</strong></td><td>Fast to detect/match, rotation-invariant, enable real-time SLAM</td></tr><tr><td><strong>Keyframes</strong></td><td>Not every frame is stored; only keyframes reduce computation</td></tr><tr><td><strong>Feature matching</strong></td><td>Descriptor matching + RANSAC outlier rejection</td></tr><tr><td><strong>Pose estimation</strong></td><td>Essential matrix decomposition from matched features</td></tr><tr><td><strong>Loop closure</strong></td><td>Place recognition + geometric verification to correct drift</td></tr><tr><td><strong>IMU fusion</strong></td><td>Improves robustness in challenging conditions</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="code-examples">Code Examples<a href="#code-examples" class="hash-link" aria-label="Direct link to Code Examples" title="Direct link to Code Examples" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-1-configure-orb-slam3-for-gazebo">Example 1: Configure ORB-SLAM3 for Gazebo<a href="#example-1-configure-orb-slam3-for-gazebo" class="hash-link" aria-label="Direct link to Example 1: Configure ORB-SLAM3 for Gazebo" title="Direct link to Example 1: Configure ORB-SLAM3 for Gazebo" translate="no">â€‹</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># code_examples/orb_slam3_config_generator.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_mono_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Generate ORB-SLAM3 config for monocular Gazebo camera&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;Camera&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PinHole&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;width&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">640</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;height&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">480</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;fx&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;fy&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;cx&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">320.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;cy&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;ORBextractor&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;nFeatures&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;scaleFactor&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;nLevels&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;ThFAST&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;System&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;useStereo&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;useRGBD&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;useIMU&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;mono_settings.yaml&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        yaml</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    generate_mono_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Config saved to mono_settings.yaml&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-2-analyze-loop-closure-performance">Example 2: Analyze Loop Closure Performance<a href="#example-2-analyze-loop-closure-performance" class="hash-link" aria-label="Direct link to Example 2: Analyze Loop Closure Performance" title="Direct link to Example 2: Analyze Loop Closure Performance" translate="no">â€‹</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># code_examples/analyze_loop_closure.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> rclpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> geometry_msgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msg </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PoseStamped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">LoopClosureAnalyzer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rclpy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;loop_closure_analyzer&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poses </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loop_closure_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Subscribe to poses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_subscription</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PoseStamped</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/orb_slam3/trajectory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose_callback</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_timer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">analyze_loop_closures</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pose_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pose </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poses</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">analyze_loop_closures</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Detect loop closures by analyzing trajectory&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poses</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        poses_array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">poses</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        current </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> poses_array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Find past poses within 0.5m distance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        distances </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">poses_array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        close_poses </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">where</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">distances </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">close_poses</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            first_close </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> close_poses</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time_since </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">poses_array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> first_close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Potential loop closure detected! &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;Revisited pose from </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">time_since</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> frames ago&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loop_closure_count </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="practice-exercise">Practice Exercise<a href="#practice-exercise" class="hash-link" aria-label="Direct link to Practice Exercise" title="Direct link to Practice Exercise" translate="no">â€‹</a></h2>
<p><strong>Objective</strong>: Configure ORB-SLAM3 and measure tracking performance</p>
<p><strong>Steps</strong>:</p>
<ol>
<li class="">Create Gazebo world with diverse features (walls, textures, objects)</li>
<li class="">Generate camera calibration config for your Gazebo camera</li>
<li class="">Launch ORB-SLAM3: <code>ros2 launch code_examples/orb_slam3_launch.py</code></li>
<li class="">Record SLAM output to ROS bag</li>
<li class="">Analyze:<!-- -->
<ul>
<li class="">Number of tracked features per frame</li>
<li class="">Loop closure detections</li>
<li class="">Pose estimation accuracy</li>
</ul>
</li>
</ol>
<p><strong>Success criteria</strong>:</p>
<ul>
<li class="">
<blockquote>
<p>500 features tracked continuously</p>
</blockquote>
</li>
<li class="">Smooth trajectory (no sudden jumps)</li>
<li class="">Loop closures detected when revisiting areas</li>
<li class="">ATE &lt;5% of path length</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References" translate="no">â€‹</a></h2>
<ul>
<li class=""><strong>ORB-SLAM3 Paper</strong>: <a href="https://arxiv.org/abs/2007.11898" target="_blank" rel="noopener noreferrer" class="">ORB-SLAM3: An Accurate Open-Source Library for Visual, Visual-Inertial and Multi-Map SLAM</a></li>
<li class=""><strong>Feature Detection</strong>: <a href="https://www.edwardrosten.com/work/fast.html" target="_blank" rel="noopener noreferrer" class="">FAST Corner Detection</a></li>
<li class=""><strong>BRIEF Descriptors</strong>: <a href="https://www.cs.ubc.ca/~lowe/papers/calonder_eccv10.pdf" target="_blank" rel="noopener noreferrer" class="">BRIEF: Computing a Local Binary Descriptor Very Fast</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps" translate="no">â€‹</a></h2>
<p>You now understand the architecture and tuning of ORB-SLAM3. Choose your next lesson:</p>
<ul>
<li class=""><strong>â†’ <a class="" href="/docs/Autonomous-Navigation/nav2-path-planning-stack">Lesson 4: Nav2 Path Planning</a></strong> (Core: use SLAM for navigation)</li>
<li class=""><strong>â†’ <a class="" href="/docs/Autonomous-Navigation/multi-sensor-perception-and-fusion">Lesson 7: Sensor Fusion</a></strong> (Advanced: combine SLAM with LiDAR/IMU)</li>
</ul>
<hr>
<p><strong>Lesson 2 Summary</strong>: ORB-SLAM3 provides complete visual SLAM using ORB features, keyframe tracking, and loop closure detection. Understanding feature detection, matching, pose estimation, and loop closure enables you to configure and debug VSLAM systems in diverse scenarios.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/your-org/ai-book/tree/main/docs/04-Autonomous-Navigation/02-visual-slam-systems.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Autonomous-Navigation/navigation-and-localization-overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lesson 1: Navigation and Localization Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Autonomous-Navigation/introduction-to-isaac-sim"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lesson 3: Introduction to Isaac Sim</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#learning-outcomes" class="table-of-contents__link toc-highlight">Learning Outcomes</a></li><li><a href="#layer-1-foundation" class="table-of-contents__link toc-highlight">Layer 1: Foundation</a><ul><li><a href="#21-orb-slam3-architecture" class="table-of-contents__link toc-highlight">2.1 ORB-SLAM3 Architecture</a></li><li><a href="#22-feature-detection-pipeline" class="table-of-contents__link toc-highlight">2.2 Feature Detection Pipeline</a></li><li><a href="#23-feature-matching" class="table-of-contents__link toc-highlight">2.3 Feature Matching</a></li><li><a href="#24-pose-estimation-from-feature-matches" class="table-of-contents__link toc-highlight">2.4 Pose Estimation from Feature Matches</a></li><li><a href="#25-local-mapping" class="table-of-contents__link toc-highlight">2.5 Local Mapping</a></li></ul></li><li><a href="#layer-2-collaboration-ros-2-integration" class="table-of-contents__link toc-highlight">Layer 2: Collaboration (ROS 2 Integration)</a><ul><li><a href="#21-orb-slam3-ros-2-wrapper" class="table-of-contents__link toc-highlight">2.1 ORB-SLAM3 ROS 2 Wrapper</a></li><li><a href="#22-rviz-visualization" class="table-of-contents__link toc-highlight">2.2 RViz Visualization</a></li></ul></li><li><a href="#layer-3-intelligence-configuration--tuning" class="table-of-contents__link toc-highlight">Layer 3: Intelligence (Configuration &amp; Tuning)</a><ul><li><a href="#31-camera-calibration" class="table-of-contents__link toc-highlight">3.1 Camera Calibration</a></li><li><a href="#32-monocular-vslam-configuration" class="table-of-contents__link toc-highlight">3.2 Monocular VSLAM Configuration</a></li><li><a href="#33-stereo-vslam-configuration" class="table-of-contents__link toc-highlight">3.3 Stereo VSLAM Configuration</a></li><li><a href="#34-performance-optimization" class="table-of-contents__link toc-highlight">3.4 Performance Optimization</a></li></ul></li><li><a href="#layer-4-advanced" class="table-of-contents__link toc-highlight">Layer 4: Advanced</a><ul><li><a href="#41-loop-closure-detection" class="table-of-contents__link toc-highlight">4.1 Loop Closure Detection</a></li><li><a href="#42-inertial-measurement-unit-imu-integration" class="table-of-contents__link toc-highlight">4.2 Inertial Measurement Unit (IMU) Integration</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#code-examples" class="table-of-contents__link toc-highlight">Code Examples</a><ul><li><a href="#example-1-configure-orb-slam3-for-gazebo" class="table-of-contents__link toc-highlight">Example 1: Configure ORB-SLAM3 for Gazebo</a></li><li><a href="#example-2-analyze-loop-closure-performance" class="table-of-contents__link toc-highlight">Example 2: Analyze Loop Closure Performance</a></li></ul></li><li><a href="#practice-exercise" class="table-of-contents__link toc-highlight">Practice Exercise</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Content</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/01-Welcome/01-introduction">Book</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/your-org/ai-book" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 AI-Native Book. Built with Docusaurus.</div></div></div></footer><button class="chat-widget-button"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg></button></div>
</body>
</html>